<form [formGroup]="serverFormGroup">
  <!--For Testing: {{ serverFormGroup.value | json }}-->

  <!--<hr>-->
  <h3>Application</h3>
  <div class="row">
    <mat-form-field>
      <mat-select placeholder="Appl Name" formControlName="application_name" [errorStateMatcher]="matcher">
        <mat-option>Clear</mat-option>
        <mat-option *ngFor="let app of applicationChoices" [value]="app.application_name">{{app.application_name}}</mat-option>
      </mat-select>
      <mat-error *ngIf="f.application_name.invalid">You must make a selection</mat-error>
    </mat-form-field>
    <button mat-button class="mat-raised-button justify-content-end col col-lg-2" color="primary" (click)="openApplicationDialog()">
      Create New Application
    </button>
    <!--<mat-form-field appearance="outline">-->
    <!--<mat-label>Application Name</mat-label>-->
    <!--<input matInput placeholder="Not To Big, Not to small"-->
    <!--formControlName="new_app_name" type="text">-->
    <!--<mat-error *ngIf="new_app_name.invalid && new_app_name.touched">-->
    <!--Name is too short or too long-->
    <!--</mat-error>-->
    <!--</mat-form-field>-->
  </div>

  <h3>Cluster</h3>
  <div class="row">
    <mat-form-field>
      <input matInput placeholder="Cluster Name" formControlName="cluster_name" type="text">
      <mat-error *ngIf="f.cluster_name.invalid && f.cluster_name.touched">
        Name is too short or too long
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-select placeholder="DBMS Type" formControlName="dbms_type" [errorStateMatcher]="matcher">
        <mat-option>Clear</mat-option>
        <mat-option *ngFor="let dbmsChoice of dbmsTypeChoices" [value]="dbmsChoice">{{dbmsChoice}}</mat-option>
      </mat-select>
      <mat-error *ngIf="f.dbms_type.invalid">You must make a selection</mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-select placeholder="Environment" formControlName="environment" [errorStateMatcher]="matcher">
        <mat-option>Clear</mat-option>
        <mat-option *ngFor="let envChoice of environmentChoices" [value]="envChoice.env_name">{{envChoice.env_name}}</mat-option>
      </mat-select>
      <mat-error *ngIf="f.environment.invalid">You must make a selection</mat-error>
    </mat-form-field>

    <mat-form-field>
      <input matInput placeholder="Backup Retention Days" formControlName="backup_retention_days">
      <mat-error *ngIf="f.backup_retention_days.invalid">Days must be from 1-35</mat-error>
    </mat-form-field>

    <mat-checkbox
      class="mat-checkbox-layout"
      [checked]
      labelPosition="after" formControlName="tls_enabled_sw">
      TLS
    </mat-checkbox>
  </div>
  <h6>Requested Resources</h6>
  <div class="row">
    <mat-form-field>
      <input matInput placeholder="CPUs" formControlName="requested_cpu" type="number">
      <mat-error *ngIf="f.requested_cpu.invalid">CPUs must be from 1-14</mat-error>
    </mat-form-field>

    <mat-form-field>
      <input matInput placeholder="RAM (GB)" formControlName="requested_ram_gb" type="number">
      <mat-error *ngIf="f.requested_ram_gb.invalid">RAM must be from 2-36 GiB</mat-error>
    </mat-form-field>

    <mat-form-field>
      <input matInput placeholder="DB (GB)" formControlName="requested_db_gb" type="number">
      <mat-error *ngIf="f.requested_db_gb.invalid">DB must be from 0-1024 GiB</mat-error>
    </mat-form-field>
  </div>
  <br>
  <div>
    <div class="row">
      <h3 class="col">Servers</h3>
      <div class="col-md-auto"></div>
      <button mat-button class="mat-raised-button justify-content-end col col-lg-2" color="primary" (click)="openServerDialog()">
        Add New Server
      </button>

    </div>
    <table class="table">
      <thead>
      <tr class="bg-clusters-header">
        <th scope="col">Env</th>
        <th scope="col">DataCenter</th>
        <th scope="col">Server Name</th>
        <th scope="col">Server IP</th>
        <th scope="col">CPU</th>
        <th scope="col">RAM (GB)</th>
        <th scope="col">DB GB</th>
        <th scope="col">Node Role</th>
      </tr>
      </thead>
      <tbody *ngFor="let s of serverFA.controls; let i = index;">
      <tr *ngIf="s" class="bg-clusters bg-hover">
        <td>{{ s.value.environment.env_name }}</td>
        <td>{{ s.value.datacenter.datacenter }}</td>
        <td>{{ s.value.server_name }}</td>
        <td>{{ s.value.server_ip }}</td>
        <td>{{ s.value.cpu }}</td>
        <td>{{ s.value.ram_gb }}</td>
        <td>{{ s.value.db_gb }}</td>
        <td>{{ s.value.node_role }}</td>
      </tr>
      </tbody>
    </table>
  </div>


  <!--<div formArrayName="phones">-->
  <!--<div *ngFor="let phone of phones.controls; let i=index" [formGroupName]="i">-->
  <!--<mat-form-field>-->
  <!--<input matInput placeholder="area" formControlName="area">-->
  <!--</mat-form-field>-->
  <!--<mat-form-field>-->
  <!--<input matInput placeholder="prefix" formControlName="prefix">-->
  <!--</mat-form-field>-->
  <!--<mat-form-field>-->
  <!--<input matInput placeholder="line" formControlName="line">-->
  <!--</mat-form-field>-->
  <!--<button mat-raised-button color="warn" (click)="deletePhone(i)">Delete</button>-->
  <!--<br>-->
  <!--</div>-->

  <!--<button mat-raised-button color="primary" (click)="addPhone()">Add Phone Number</button>-->
  <button mat-raised-button [disabled]="serverFormGroup.invalid" color="primary" (click)="addClusterToDB()">Just Add to DB</button>
  <button mat-raised-button [disabled]="serverFormGroup.invalid" color="primary" (click)="createCluster()" disabled>Create a Cluster</button>
</form>
